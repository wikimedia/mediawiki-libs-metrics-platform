# Autogenerated by pipeline-to-gitlab
include:
  - project: 'repos/releng/kokkuri'
    file: 'includes/images.yaml'

variables:
  GIT_SUBMODULE_STRATEGY: recursive
    
stages:
- test

test-java:
  extends: .kokkuri:build-and-run-image
  rules:
  - if: $CI_PIPELINE_SOURCE == "push" && $CI_COMMIT_BRANCH != $CI_DEFAULT_BRANCH
    changes:
      - .mvn/**/*
      - java/**/*
      - mvnw
      - mvwn.cmnd
  stage: test
  variables:
    BUILD_CONFIG: .pipeline/blubber-java.yaml
    BUILD_VARIANT: test

test-js:
  extends: .kokkuri:build-and-run-image
  rules:
  - if: $CI_PIPELINE_SOURCE == "push" && $CI_COMMIT_BRANCH != $CI_DEFAULT_BRANCH
    changes:
      - js/**/*
  stage: test
  variables:
    BUILD_VARIANT: test
    BUILD_CONTEXT: js

test-php:
  extends: .kokkuri:build-and-run-image
  rules:
  - if: $CI_PIPELINE_SOURCE == "push" && $CI_COMMIT_BRANCH != $CI_DEFAULT_BRANCH
    changes:
      - .phan/**/*
      - php/**/*
      - .phpcs.xml
      - composer.json
      - composer.lock
  stage: test
  variables:
    BUILD_CONFIG: .pipeline/blubber-php.yaml
    BUILD_VARIANT: test

test-swift:
  extends: .kokkuri:build-and-run-image
  rules:
  - if: $CI_PIPELINE_SOURCE == "push" && $CI_COMMIT_BRANCH != $CI_DEFAULT_BRANCH
    changes:
      - swift/**/*
  stage: test
  variables:
    BUILD_VARIANT: test
    BUILD_CONTEXT: swift
